paddle.incubate.nn.functional.fused_feedforward(Tensor([32, 128, 768],"float16"), Tensor([768, 3072],"float16"), Tensor([3072, 768],"float16"), Tensor([3072],"float16"), Tensor([768],"float16"), None, None, Tensor([768],"float32"), Tensor([768],"float32"), dropout1_rate=0.0, dropout2_rate=0.1, activation="gelu", ln1_epsilon=1e-05, ln2_epsilon=1e-05, pre_layer_norm=False, training=True, ring_id=-1, name=None, )
W0520 06:57:33.867820 989263 gpu_resources.cc:119] Please NOTE: device: 0, GPU Compute Capability: 8.9, Driver API Version: 12.2, Runtime API Version: 11.8
W0520 06:57:33.868624 989263 gpu_resources.cc:164] device: 0, cuDNN Version: 8.8.
[accuracy error] paddle.incubate.nn.functional.fused_feedforward(Tensor([32, 128, 768],"float16"), Tensor([768, 3072],"float16"), Tensor([3072, 768],"float16"), Tensor([3072],"float16"), Tensor([768],"float16"), None, None, Tensor([768],"float32"), Tensor([768],"float32"), dropout1_rate=0.0, dropout2_rate=0.1, activation="gelu", ln1_epsilon=1e-05, ln2_epsilon=1e-05, pre_layer_norm=False, training=True, ring_id=-1, name=None, ) 
 
Not equal to tolerance rtol=0.01, atol=0.01

Mismatched elements: 640184 / 3145728 (20.4%)
Max absolute difference: 2.166378
Max relative difference: 128602.08
 x: array([[[ 0.322   , -0.2303  ,  0.518   , ..., -0.4824  ,  0.4478  ,
          0.4531  ],
        [ 0.3042  , -0.1644  ,  0.4     , ..., -0.4387  ,  0.4607  ,...
 y: array([[[ 3.207831e-01, -2.300416e-01,  5.157322e-01, ...,
         -4.830118e-01,  4.483968e-01,  4.558054e-01],
        [ 3.059850e-01, -1.660515e-01,  4.051207e-01, ...,...

paddle.incubate.nn.functional.fused_feedforward(Tensor([64, 128, 768],"float16"), Tensor([768, 3072],"float16"), Tensor([3072, 768],"float16"), Tensor([3072],"float16"), Tensor([768],"float16"), None, None, Tensor([768],"float32"), Tensor([768],"float32"), dropout1_rate=0.0, dropout2_rate=0.1, activation="gelu", ln1_epsilon=1e-05, ln2_epsilon=1e-05, pre_layer_norm=False, training=True, ring_id=-1, name=None, )
[accuracy error] paddle.incubate.nn.functional.fused_feedforward(Tensor([64, 128, 768],"float16"), Tensor([768, 3072],"float16"), Tensor([3072, 768],"float16"), Tensor([3072],"float16"), Tensor([768],"float16"), None, None, Tensor([768],"float32"), Tensor([768],"float32"), dropout1_rate=0.0, dropout2_rate=0.1, activation="gelu", ln1_epsilon=1e-05, ln2_epsilon=1e-05, pre_layer_norm=False, training=True, ring_id=-1, name=None, ) 
 
Not equal to tolerance rtol=0.01, atol=0.01

Mismatched elements: 1291062 / 6291456 (20.5%)
Max absolute difference: 2.2072542
Max relative difference: 6229753.
 x: array([[[ 0.9385  ,  0.03418 , -0.006767, ..., -0.594   ,  0.4001  ,
          0.507   ],
        [ 0.5654  ,  0.4724  ,  0.4792  , ..., -0.804   ,  0.742   ,...
 y: array([[[ 0.957242,  0.028278, -0.002203, ..., -0.586348,  0.24448 ,
          0.516183],
        [ 0.579527,  0.46821 ,  0.224385, ..., -0.79653 ,  0.7381  ,...

paddle.incubate.nn.functional.fused_feedforward(Tensor([96, 128, 768],"float16"), Tensor([768, 3072],"float16"), Tensor([3072, 768],"float16"), Tensor([3072],"float16"), Tensor([768],"float16"), None, None, Tensor([768],"float32"), Tensor([768],"float32"), dropout1_rate=0.0, dropout2_rate=0.1, activation="gelu", ln1_epsilon=1e-05, ln2_epsilon=1e-05, pre_layer_norm=False, training=True, ring_id=-1, name=None, )
[accuracy error] paddle.incubate.nn.functional.fused_feedforward(Tensor([96, 128, 768],"float16"), Tensor([768, 3072],"float16"), Tensor([3072, 768],"float16"), Tensor([3072],"float16"), Tensor([768],"float16"), None, None, Tensor([768],"float32"), Tensor([768],"float32"), dropout1_rate=0.0, dropout2_rate=0.1, activation="gelu", ln1_epsilon=1e-05, ln2_epsilon=1e-05, pre_layer_norm=False, training=True, ring_id=-1, name=None, ) 
 
Not equal to tolerance rtol=0.01, atol=0.01

Mismatched elements: 1937316 / 9437184 (20.5%)
Max absolute difference: 2.1684518
Max relative difference: 566795.6
 x: array([[[ 0.644   , -0.3992  , -0.5874  , ..., -0.2524  , -0.4158  ,
          0.2233  ],
        [ 0.6885  , -0.3892  , -0.675   , ...,  0.316   , -0.6753  ,...
 y: array([[[ 0.645142, -0.398207, -0.591769, ..., -0.250951, -0.403753,
          0.224271],
        [ 0.662082, -0.437331, -0.674832, ..., -0.184503, -0.671646,...

paddle.incubate.nn.functional.fused_feedforward(Tensor([32, 128, 768],"float32"), Tensor([768, 3072],"float32"), Tensor([3072, 768],"float32"), Tensor([3072],"float32"), Tensor([768],"float32"), None, None, Tensor([768],"float32"), Tensor([768],"float32"), dropout1_rate=0.0, dropout2_rate=0.1, activation="gelu", ln1_epsilon=1e-05, ln2_epsilon=1e-05, pre_layer_norm=False, training=True, ring_id=-1, name=None, )
[accuracy error] paddle.incubate.nn.functional.fused_feedforward(Tensor([32, 128, 768],"float32"), Tensor([768, 3072],"float32"), Tensor([3072, 768],"float32"), Tensor([3072],"float32"), Tensor([768],"float32"), None, None, Tensor([768],"float32"), Tensor([768],"float32"), dropout1_rate=0.0, dropout2_rate=0.1, activation="gelu", ln1_epsilon=1e-05, ln2_epsilon=1e-05, pre_layer_norm=False, training=True, ring_id=-1, name=None, ) 
 
Not equal to tolerance rtol=0.01, atol=0.01

Mismatched elements: 647290 / 3145728 (20.6%)
Max absolute difference: 2.1399825
Max relative difference: 749830.56
 x: array([[[ 0.139155,  0.021098, -1.13633 , ..., -0.402743,  0.724014,
          0.312263],
        [ 0.319341,  0.159811, -1.129142, ..., -0.306275,  0.568991,...
 y: array([[[ 0.133347,  0.026291, -1.143366, ..., -0.396423,  0.719948,
          0.300632],
        [ 0.317316,  0.15765 , -1.12235 , ..., -0.394061,  0.568388,...

paddle.incubate.nn.functional.fused_feedforward(Tensor([64, 128, 768],"float32"), Tensor([768, 3072],"float32"), Tensor([3072, 768],"float32"), Tensor([3072],"float32"), Tensor([768],"float32"), None, None, Tensor([768],"float32"), Tensor([768],"float32"), dropout1_rate=0.0, dropout2_rate=0.1, activation="gelu", ln1_epsilon=1e-05, ln2_epsilon=1e-05, pre_layer_norm=False, training=True, ring_id=-1, name=None, )
[accuracy error] paddle.incubate.nn.functional.fused_feedforward(Tensor([64, 128, 768],"float32"), Tensor([768, 3072],"float32"), Tensor([3072, 768],"float32"), Tensor([3072],"float32"), Tensor([768],"float32"), None, None, Tensor([768],"float32"), Tensor([768],"float32"), dropout1_rate=0.0, dropout2_rate=0.1, activation="gelu", ln1_epsilon=1e-05, ln2_epsilon=1e-05, pre_layer_norm=False, training=True, ring_id=-1, name=None, ) 
 
Not equal to tolerance rtol=0.01, atol=0.01

Mismatched elements: 1277708 / 6291456 (20.3%)
Max absolute difference: 2.1496427
Max relative difference: 924262.
 x: array([[[ 0.326614, -0.527633,  0.307524, ..., -0.142242,  0.542929,
         -0.405039],
        [ 0.233473, -0.087752,  0.372344, ..., -0.421725,  0.587574,...
 y: array([[[ 0.332149, -0.534159,  0.312874, ..., -0.154248,  0.528874,
         -0.857611],
        [ 0.231129, -0.089373,  0.371569, ..., -0.425756,  0.59514 ,...

paddle.incubate.nn.functional.fused_feedforward(Tensor([96, 128, 768],"float32"), Tensor([768, 3072],"float32"), Tensor([3072, 768],"float32"), Tensor([3072],"float32"), Tensor([768],"float32"), None, None, Tensor([768],"float32"), Tensor([768],"float32"), dropout1_rate=0.0, dropout2_rate=0.1, activation="gelu", ln1_epsilon=1e-05, ln2_epsilon=1e-05, pre_layer_norm=False, training=True, ring_id=-1, name=None, )
[accuracy error] paddle.incubate.nn.functional.fused_feedforward(Tensor([96, 128, 768],"float32"), Tensor([768, 3072],"float32"), Tensor([3072, 768],"float32"), Tensor([3072],"float32"), Tensor([768],"float32"), None, None, Tensor([768],"float32"), Tensor([768],"float32"), dropout1_rate=0.0, dropout2_rate=0.1, activation="gelu", ln1_epsilon=1e-05, ln2_epsilon=1e-05, pre_layer_norm=False, training=True, ring_id=-1, name=None, ) 
 
Not equal to tolerance rtol=0.01, atol=0.01

Mismatched elements: 1915868 / 9437184 (20.3%)
Max absolute difference: 2.285069
Max relative difference: 891046.25
 x: array([[[-8.870396e-01, -1.889203e-01, -2.949312e-01, ...,
          6.360562e-02, -3.221052e-01,  1.317146e-01],
        [-2.566716e-01, -1.777433e-01, -1.594194e-01, ...,...
 y: array([[[-0.882622, -0.188844, -0.292981, ...,  0.059785, -0.323212,
          0.130975],
        [-0.263354, -0.177875, -0.136377, ..., -0.324993, -0.042504,...

paddle.incubate.nn.functional.fused_feedforward(Tensor([32, 128, 768],"float16"), Tensor([768, 3072],"float16"), Tensor([3072, 768],"float16"), Tensor([3072],"float16"), Tensor([768],"float16"), None, None, Tensor([768],"float32"), Tensor([768],"float32"), dropout1_rate=0.0, dropout2_rate=0.1, activation="gelu", ln1_epsilon=1e-05, ln2_epsilon=1e-05, pre_layer_norm=False, training=True, ring_id=-1, name=None, )
W0523 04:49:27.286219 2102306 gpu_resources.cc:119] Please NOTE: device: 0, GPU Compute Capability: 8.9, Driver API Version: 12.2, Runtime API Version: 11.8
W0523 04:49:27.286958 2102306 gpu_resources.cc:164] device: 0, cuDNN Version: 8.8.
[accuracy error] paddle.incubate.nn.functional.fused_feedforward(Tensor([32, 128, 768],"float16"), Tensor([768, 3072],"float16"), Tensor([3072, 768],"float16"), Tensor([3072],"float16"), Tensor([768],"float16"), None, None, Tensor([768],"float32"), Tensor([768],"float32"), dropout1_rate=0.0, dropout2_rate=0.1, activation="gelu", ln1_epsilon=1e-05, ln2_epsilon=1e-05, pre_layer_norm=False, training=True, ring_id=-1, name=None, ) 
 Not equal to tolerance rtol=0.01, atol=0.01
Mismatched elements: 649540 / 3145728 (20.6%)
Greatest absolute difference: 2.107421875 at index (6, 55, 671) (up to 0.01 allowed)
Greatest relative difference: inf at index (4, 118, 245) (up to 0.01 allowed)
ACTUAL: (shape=torch.Size([32, 128, 768]), dtype=torch.float16)
First 100 elements: tensor([-0.3003, -0.1826,  0.0183, -0.7095, -0.3962,  0.1874, -0.1726,  0.3320,
        -0.1537, -0.0682, -0.2085,  0.6343, -0.0916,  0.2844, -0.5264,  0.0895,
        -0.4216,  0.4961, -0.0445,  0.8125, -0.0245, -0.5005,  0.3503,  0.7192,
        -0.0055, -0.2878,  0.0504,  0.0072,  0.2117,  0.1070, -0.5396,  0.3079,
         0.2058,  0.3438, -0.1171, -0.2607,  0.2937, -0.8037,  0.3157, -0.6006,
        -0.3728, -0.4905,  0.5547, -0.4036, -0.0739, -0.2158,  0.7310,  0.0063,
        -0.2162, -0.0613, -0.1255, -0.5063, -0.3669,  0.0381, -0.1155,  0.4763,
         0.9463,  0.2673, -0.4036, -0.2399, -0.3389,  0.3943, -0.2181, -0.0330,
        -0.2078, -0.1533, -0.6289, -0.5903, -0.1821,  0.3879, -0.5459,  0.7129,
         0.2161, -0.5015,  0.7305, -0.1178, -0.6250,  0.3364, -0.0920,  0.4521,
         0.4177, -0.0115, -0.2637, -0.4204,  0.8472,  0.0817,  0.1940,  0.1572,
         0.2083,  0.3032, -0.0718, -0.0596, -0.0102, -0.1035, -0.0954, -0.8672,
        -0.5469, -0.0811,  0.2482,  0.1169], dtype=torch.float16)
DESIRED: (shape=torch.Size([32, 128, 768]), dtype=torch.float16)
First 100 elements: tensor([-0.2993, -0.1819,  0.0200, -0.7070, -0.3972,  0.1857, -0.1886,  0.3303,
        -0.1547, -0.0676, -0.2083,  0.6328, -0.0897,  0.2822, -0.5269,  0.1394,
        -0.4207,  0.4985, -0.0463,  0.8096, -0.0224, -0.5020,  0.6133,  0.7183,
        -0.1675, -0.2883,  0.0509, -0.3333,  0.2103,  0.1053, -0.5371,  0.3083,
         0.2040,  0.3406, -0.1176, -0.2585,  0.2944, -0.8057,  0.3223, -0.6011,
        -0.3735, -0.4907,  0.5552, -0.4026, -0.0743, -0.2159,  0.7314,  0.0059,
        -0.3394, -0.0635, -0.1274, -0.5039, -0.3662,  0.0391, -0.1181,  0.4741,
         0.9482,  0.2686, -0.4048, -0.4570, -0.3401,  0.3931, -0.2168, -0.0309,
        -0.2073, -0.1528, -0.6274, -0.5908, -0.1833,  0.3706, -0.5449,  0.7144,
         0.2141, -0.5005,  0.7319, -0.1190, -0.6270,  0.3350, -0.0932,  0.4529,
         0.4172, -0.0121, -0.2634, -0.4192,  0.8486,  0.0828,  0.2302,  0.1558,
         0.2092,  0.3013, -0.1243, -0.0598, -0.0113, -0.1065, -0.0035, -0.8691,
        -0.5459, -0.0831,  0.2467,  0.1173], dtype=torch.float16)

paddle.incubate.nn.functional.fused_feedforward(Tensor([64, 128, 768],"float16"), Tensor([768, 3072],"float16"), Tensor([3072, 768],"float16"), Tensor([3072],"float16"), Tensor([768],"float16"), None, None, Tensor([768],"float32"), Tensor([768],"float32"), dropout1_rate=0.0, dropout2_rate=0.1, activation="gelu", ln1_epsilon=1e-05, ln2_epsilon=1e-05, pre_layer_norm=False, training=True, ring_id=-1, name=None, )
[accuracy error] paddle.incubate.nn.functional.fused_feedforward(Tensor([64, 128, 768],"float16"), Tensor([768, 3072],"float16"), Tensor([3072, 768],"float16"), Tensor([3072],"float16"), Tensor([768],"float16"), None, None, Tensor([768],"float32"), Tensor([768],"float32"), dropout1_rate=0.0, dropout2_rate=0.1, activation="gelu", ln1_epsilon=1e-05, ln2_epsilon=1e-05, pre_layer_norm=False, training=True, ring_id=-1, name=None, ) 
 Not equal to tolerance rtol=0.01, atol=0.01
Mismatched elements: 1319387 / 6291456 (21.0%)
Greatest absolute difference: 2.25390625 at index (24, 58, 400) (up to 0.01 allowed)
Greatest relative difference: inf at index (1, 10, 208) (up to 0.01 allowed)
ACTUAL: (shape=torch.Size([64, 128, 768]), dtype=torch.float16)
First 100 elements: tensor([ 0.3342, -0.4421, -0.2297,  0.2012, -0.1191, -0.3372,  1.0771,  0.3433,
        -0.2430,  0.0548,  0.2559, -0.1769,  0.0509,  0.4358, -0.3955, -1.5293,
         0.3257, -0.3105, -0.3870,  0.0667,  0.2959,  0.4307, -0.4153,  0.0859,
         0.0695,  0.0604,  0.3518, -0.1569,  0.2214,  0.1055,  0.1715, -0.3657,
         0.1134, -0.4966, -0.5630, -0.1549,  0.8823, -0.6167, -0.3887,  0.2808,
         0.1233, -0.2524,  0.1516,  0.6934, -0.0244, -0.3992,  0.5664, -0.2668,
         0.3137, -0.4138,  0.3191,  0.0745, -0.8359, -0.2053, -0.0037,  0.3286,
        -0.2123, -0.0113,  0.3774,  0.1227, -0.4990,  0.0256, -0.9072,  0.7056,
        -0.3523, -1.0059,  0.3149,  0.4241, -0.3442, -0.5513, -0.2515, -0.7080,
         0.4871,  0.2568,  0.9517,  0.0368, -0.1700,  0.5283,  0.1293,  1.5098,
         0.2064, -0.4895,  0.4702, -0.4731, -0.1899,  0.4727,  0.0053,  0.7188,
         0.4087,  0.4138,  1.2578, -0.9165, -0.3892, -0.4170,  0.5537, -0.2163,
         0.4124, -0.1285,  0.4880, -0.3892], dtype=torch.float16)
DESIRED: (shape=torch.Size([64, 128, 768]), dtype=torch.float16)
First 100 elements: tensor([ 0.3376, -0.4417, -0.2307,  0.2076, -0.1182, -0.3359,  1.0869,  0.3457,
        -0.2406,  0.0603,  0.2573,  0.4434,  0.0527,  0.4355, -0.3914, -1.5439,
         0.3279, -0.3120, -0.3879,  0.0677,  0.2959,  0.1310, -0.4150,  0.0846,
         0.0742,  0.3584,  0.3518, -0.1573,  0.2249,  0.1075,  0.1682, -0.3667,
         0.1106, -0.4976, -0.5601, -0.1528,  0.8882, -0.6172, -0.3884,  0.2820,
         0.1256, -0.2563,  0.1555,  0.6982, -0.0182, -0.3979, -0.1846, -0.2656,
         0.3223, -0.4150,  0.3191, -0.0809, -0.8433, -0.2034, -0.0017,  0.3293,
        -0.2129, -0.0106,  0.3757,  0.1201, -0.5020,  0.0246, -0.9141,  0.7065,
        -0.3491, -1.0146,  0.3154,  0.4270, -0.3469, -0.5532, -0.2529, -0.7158,
         0.4932,  0.2593,  0.9609,  0.0391, -0.1715,  0.5298,  0.1279,  1.5176,
         0.2048, -0.4863,  0.4695,  0.1425, -0.1870,  0.4763, -0.2085,  0.7251,
         0.4087,  0.1298,  1.2617, -0.9248, -0.3960, -0.4192,  0.5610, -0.2223,
         0.4773, -0.1287,  0.4897, -0.3921], dtype=torch.float16)

paddle.incubate.nn.functional.fused_feedforward(Tensor([96, 128, 768],"float16"), Tensor([768, 3072],"float16"), Tensor([3072, 768],"float16"), Tensor([3072],"float16"), Tensor([768],"float16"), None, None, Tensor([768],"float32"), Tensor([768],"float32"), dropout1_rate=0.0, dropout2_rate=0.1, activation="gelu", ln1_epsilon=1e-05, ln2_epsilon=1e-05, pre_layer_norm=False, training=True, ring_id=-1, name=None, )
[accuracy error] paddle.incubate.nn.functional.fused_feedforward(Tensor([96, 128, 768],"float16"), Tensor([768, 3072],"float16"), Tensor([3072, 768],"float16"), Tensor([3072],"float16"), Tensor([768],"float16"), None, None, Tensor([768],"float32"), Tensor([768],"float32"), dropout1_rate=0.0, dropout2_rate=0.1, activation="gelu", ln1_epsilon=1e-05, ln2_epsilon=1e-05, pre_layer_norm=False, training=True, ring_id=-1, name=None, ) 
 Not equal to tolerance rtol=0.01, atol=0.01
Mismatched elements: 1957618 / 9437184 (20.7%)
Greatest absolute difference: 2.39453125 at index (54, 77, 720) (up to 0.01 allowed)
Greatest relative difference: inf at index (8, 98, 359) (up to 0.01 allowed)
ACTUAL: (shape=torch.Size([96, 128, 768]), dtype=torch.float16)
First 100 elements: tensor([-0.5215,  0.0530, -0.8931, -0.0418,  0.0867,  0.8457,  0.6104, -0.0432,
        -0.7139,  0.0362, -0.0078, -0.1095,  0.2742, -0.4536,  1.2354,  0.2402,
         0.0661, -0.6523, -0.7734,  0.0929,  0.1984,  0.3975, -0.6196,  0.3652,
        -0.2649,  0.4592,  0.4705, -0.0621,  0.4409, -0.2581, -0.6172,  0.6440,
        -0.3274, -0.3779,  0.4011,  0.6431,  0.1980, -0.2101,  0.1231,  0.1617,
        -0.4043, -0.2003, -0.3618, -0.3625,  0.2874,  0.7915,  0.2805, -0.0415,
         1.1318, -0.3201, -0.0029,  0.3110,  0.1403,  0.2671,  0.7012,  0.0552,
        -0.1016,  0.3364,  0.4504, -0.1984,  0.3132,  0.4146, -0.1667, -0.1830,
        -0.3242, -0.1602,  0.5625, -0.2378,  0.1300, -0.7178, -0.4573, -0.4646,
        -0.2869,  0.2290,  0.2250, -0.2452,  0.0905, -0.7178, -0.3235, -0.0075,
        -0.3699, -0.3054, -0.1213, -0.2489, -0.4846,  0.9375, -0.0233,  0.5732,
         0.3503, -0.0361, -0.2393,  0.0625,  0.2766,  0.6162,  0.2111, -0.0934,
         0.3740, -0.8438,  0.0135, -0.0700], dtype=torch.float16)
DESIRED: (shape=torch.Size([96, 128, 768]), dtype=torch.float16)
First 100 elements: tensor([-0.5156,  0.0573, -0.8823, -0.0424,  0.0784,  0.8159,  0.6118, -0.0392,
        -0.7026, -0.2664,  0.0014, -0.0994,  0.3730, -0.4480,  1.2168,  0.2487,
         0.0483, -0.6357, -0.7598,  0.0960,  0.2012,  0.3899, -0.6211,  0.3594,
        -0.2773,  0.4507,  0.4773, -0.0634,  0.4346, -0.2534, -0.6133,  0.1680,
        -0.3267, -0.3743,  0.3848,  0.6182,  0.2050, -0.1987,  0.4946,  0.1616,
        -0.4038, -0.1997, -0.3582, -0.3564,  0.2842,  0.7896,  0.3276, -0.0403,
         1.1045, -0.3311,  0.0087,  0.3105,  0.1379,  0.2773,  0.6938,  0.0428,
        -0.1113,  0.3298,  0.3923, -0.1887,  0.3198,  0.4062, -0.1644, -0.6592,
        -0.3220, -0.1451,  0.5630, -0.4375,  0.1301, -0.7100, -0.3477, -0.4607,
         0.3887,  0.2274,  0.2141, -0.2450,  0.0684, -0.7139, -0.3171,  0.0331,
        -0.3198, -0.3113, -0.1274, -0.2499, -0.4790,  0.9004, -0.0219,  0.5732,
         0.3479, -0.0225, -0.2347,  0.0537,  0.7925,  0.2170,  0.2050, -0.0925,
         0.3784, -0.8374,  0.0083, -0.0695], dtype=torch.float16)

